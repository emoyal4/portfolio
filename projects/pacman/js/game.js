'use strict'

const WALL = 'â¬œ'
const FOOD = '.'
const SUPER_FOOD = '@'
const EMPTY = ' '
const CHERRY = '*'

var foodImg = `<img class="icon food" src="./img/food.png">`
var superFoodImg = `<img class="icon super-food" src="./img/food.png">`
var cherryImg = `<img class="icon cherry" src="./img/cherry.png">`


var gBoard
var gFoodCount = 0
var gCherryCount = 0
var cherryInterval


var gGame = {
    score: 1,
    isOn: false
}

function init() {
    gBoard = buildBoard()
    createPacman(gBoard);
    createGhosts(gBoard);
    printBoard(gBoard, '.board-container')

    cherryInterval = setInterval(addNewCherry, 15000)

    gGame.isOn = true
}

function buildBoard() {
    var SIZE = 27;
    var board = [];
    for (var i = 0; i < SIZE; i++) {
        board.push([]);
        for (var j = 0; j < SIZE; j++) {
            board[i][j] = FOOD;
            gFoodCount++

            if (i === 1 && j === 1 || i === 1 && j === SIZE - 2 || i === SIZE - 2 && j === 3 || i === SIZE - 2 && j === SIZE - 3) {
                board[i][j] = SUPER_FOOD;
                gFoodCount--
            }

            if (i === 0 || i === SIZE - 1 ||
                j === 0 || j === SIZE - 1 ||
                (i === 1 && j === 13) ||
                (i === 1 && j === 14) ||
                (i === 2 && j === 2) ||
                (i === 2 && j === 3) ||
                (i === 2 && j === 4) ||
                (i === 2 && j === 5) ||
                (i === 2 && j === 7) ||
                (i === 2 && j === 8) ||
                (i === 2 && j === 9) ||
                (i === 2 && j === 10) ||
                (i === 2 && j === 11) ||
                (i === 2 && j === 13) ||
                (i === 2 && j === 14) ||
                (i === 2 && j === 16) ||
                (i === 2 && j === 17) ||
                (i === 2 && j === 18) ||
                (i === 2 && j === 19) ||
                (i === 2 && j === 20) ||
                (i === 2 && j === 22) ||
                (i === 2 && j === 23) ||
                (i === 2 && j === 24) ||
                (i === 2 && j === 25) ||
                (i === 3 && j === 3) ||
                (i === 3 && j === 4) ||
                (i === 3 && j === 5) ||
                (i === 3 && j === 7) ||
                (i === 3 && j === 8) ||
                (i === 3 && j === 9) ||
                (i === 3 && j === 10) ||
                (i === 3 && j === 11) ||
                (i === 3 && j === 13) ||
                (i === 3 && j === 14) ||
                (i === 3 && j === 16) ||
                (i === 3 && j === 17) ||
                (i === 3 && j === 18) ||
                (i === 3 && j === 19) ||
                (i === 3 && j === 20) ||
                (i === 3 && j === 22) ||
                (i === 3 && j === 23) ||
                (i === 3 && j === 24) ||
                (i === 3 && j === 25) ||
                (i === 4 && j === 3) ||
                (i === 4 && j === 4) ||
                (i === 4 && j === 5) ||
                (i === 4 && j === 7) ||
                (i === 4 && j === 8) ||
                (i === 4 && j === 9) ||
                (i === 4 && j === 10) ||
                (i === 4 && j === 11) ||
                (i === 4 && j === 13) ||
                (i === 4 && j === 14) ||
                (i === 4 && j === 16) ||
                (i === 4 && j === 17) ||
                (i === 4 && j === 18) ||
                (i === 4 && j === 19) ||
                (i === 4 && j === 20) ||
                (i === 4 && j === 22) ||
                (i === 4 && j === 23) ||
                (i === 4 && j === 24) ||
                (i === 4 && j === 25) ||
                (i === 6 && j === 2) ||
                (i === 6 && j === 3) ||
                (i === 6 && j === 4) ||
                (i === 6 && j === 5) ||
                (i === 6 && j === 7) ||
                (i === 6 && j === 8) ||
                (i === 6 && j === 10) ||
                (i === 6 && j === 11) ||
                (i === 6 && j === 12) ||
                (i === 6 && j === 13) ||
                (i === 6 && j === 14) ||
                (i === 6 && j === 15) ||
                (i === 6 && j === 16) ||
                (i === 6 && j === 17) ||
                (i === 6 && j === 19) ||
                (i === 6 && j === 20) ||
                (i === 6 && j === 22) ||
                (i === 6 && j === 23) ||
                (i === 6 && j === 24) ||
                (i === 6 && j === 25) ||
                (i === 7 && j === 2) ||
                (i === 7 && j === 3) ||
                (i === 7 && j === 4) ||
                (i === 7 && j === 5) ||
                (i === 7 && j === 7) ||
                (i === 7 && j === 8) ||
                (i === 7 && j === 13) ||
                (i === 7 && j === 14) ||
                (i === 7 && j === 19) ||
                (i === 7 && j === 20) ||
                (i === 7 && j === 22) ||
                (i === 7 && j === 23) ||
                (i === 7 && j === 24) ||
                (i === 7 && j === 25) ||
                (i === 8 && j === 7) ||
                (i === 8 && j === 8) ||
                (i === 8 && j === 9) ||
                (i === 8 && j === 10) ||
                (i === 8 && j === 11) ||
                (i === 8 && j === 13) ||
                (i === 8 && j === 14) ||
                (i === 8 && j === 16) ||
                (i === 8 && j === 17) ||
                (i === 8 && j === 18) ||
                (i === 8 && j === 19) ||
                (i === 8 && j === 20) ||
                (i === 9 && j === 1) ||
                (i === 9 && j === 2) ||
                (i === 9 && j === 3) ||
                (i === 9 && j === 4) ||
                (i === 9 && j === 5) ||
                (i === 9 && j === 7) ||
                (i === 9 && j === 8) ||
                (i === 9 && j === 9) ||
                (i === 9 && j === 10) ||
                (i === 9 && j === 11) ||
                (i === 9 && j === 13) ||
                (i === 9 && j === 14) ||
                (i === 9 && j === 16) ||
                (i === 9 && j === 17) ||
                (i === 9 && j === 18) ||
                (i === 9 && j === 19) ||
                (i === 9 && j === 20) ||
                (i === 9 && j === 22) ||
                (i === 9 && j === 23) ||
                (i === 9 && j === 24) ||
                (i === 9 && j === 25) ||
                (i === 9 && j === 26) ||
                (i === 10 && j === 1) ||
                (i === 10 && j === 2) ||
                (i === 10 && j === 3) ||
                (i === 10 && j === 4) ||
                (i === 10 && j === 5) ||
                (i === 10 && j === 7) ||
                (i === 10 && j === 8) ||
                (i === 10 && j === 19) ||
                (i === 10 && j === 20) ||
                (i === 10 && j === 22) ||
                (i === 10 && j === 23) ||
                (i === 10 && j === 24) ||
                (i === 10 && j === 25) ||
                (i === 10 && j === 26) ||
                (i === 11 && j === 1) ||
                (i === 11 && j === 2) ||
                (i === 11 && j === 3) ||
                (i === 11 && j === 4) ||
                (i === 11 && j === 5) ||
                (i === 11 && j === 7) ||
                (i === 11 && j === 8) ||
                (i === 11 && j === 10) ||
                (i === 11 && j === 11) ||
                (i === 11 && j === 12) ||
                (i === 11 && j === 13) ||
                (i === 11 && j === 14) ||
                (i === 11 && j === 15) ||
                (i === 11 && j === 16) ||
                (i === 11 && j === 17) ||
                (i === 11 && j === 19) ||
                (i === 11 && j === 20) ||
                (i === 11 && j === 22) ||
                (i === 11 && j === 23) ||
                (i === 11 && j === 24) ||
                (i === 11 && j === 25) ||
                (i === 11 && j === 26) ||
                (i === 12 && j === 1) ||
                (i === 12 && j === 2) ||
                (i === 12 && j === 3) ||
                (i === 12 && j === 4) ||
                (i === 12 && j === 5) ||
                (i === 12 && j === 7) ||
                (i === 12 && j === 8) ||
                (i === 12 && j === 10) ||
                (i === 12 && j === 11) ||
                (i === 12 && j === 12) ||
                (i === 12 && j === 13) ||
                (i === 12 && j === 14) ||
                (i === 12 && j === 15) ||
                (i === 12 && j === 16) ||
                (i === 12 && j === 17) ||
                (i === 12 && j === 19) ||
                (i === 12 && j === 20) ||
                (i === 12 && j === 22) ||
                (i === 12 && j === 23) ||
                (i === 12 && j === 24) ||
                (i === 12 && j === 25) ||
                (i === 12 && j === 26) ||
                (i === 13 && j === 1) ||
                (i === 13 && j === 2) ||
                (i === 13 && j === 3) ||
                (i === 13 && j === 4) ||
                (i === 13 && j === 5) ||
                (i === 13 && j === 7) ||
                (i === 13 && j === 8) ||
                (i === 13 && j === 10) ||
                (i === 13 && j === 11) ||
                (i === 13 && j === 12) ||
                (i === 13 && j === 13) ||
                (i === 13 && j === 14) ||
                (i === 13 && j === 15) ||
                (i === 13 && j === 16) ||
                (i === 13 && j === 17) ||
                (i === 13 && j === 19) ||
                (i === 13 && j === 20) ||
                (i === 13 && j === 22) ||
                (i === 13 && j === 23) ||
                (i === 13 && j === 24) ||
                (i === 13 && j === 25) ||
                (i === 13 && j === 26) ||
                (i === 14 && j === 10) ||
                (i === 14 && j === 11) ||
                (i === 14 && j === 12) ||
                (i === 14 && j === 13) ||
                (i === 14 && j === 14) ||
                (i === 14 && j === 15) ||
                (i === 14 && j === 16) ||
                (i === 14 && j === 17) ||
                (i === 15 && j === 1) ||
                (i === 15 && j === 2) ||
                (i === 15 && j === 3) ||
                (i === 15 && j === 4) ||
                (i === 15 && j === 5) ||
                (i === 15 && j === 7) ||
                (i === 15 && j === 8) ||
                (i === 15 && j === 10) ||
                (i === 15 && j === 11) ||
                (i === 15 && j === 12) ||
                (i === 15 && j === 13) ||
                (i === 15 && j === 14) ||
                (i === 15 && j === 15) ||
                (i === 15 && j === 16) ||
                (i === 15 && j === 17) ||
                (i === 15 && j === 19) ||
                (i === 15 && j === 20) ||
                (i === 15 && j === 22) ||
                (i === 15 && j === 23) ||
                (i === 15 && j === 24) ||
                (i === 15 && j === 25) ||
                (i === 15 && j === 26) ||
                (i === 16 && j === 1) ||
                (i === 16 && j === 2) ||
                (i === 16 && j === 3) ||
                (i === 16 && j === 4) ||
                (i === 16 && j === 5) ||
                (i === 16 && j === 7) ||
                (i === 16 && j === 8) ||
                (i === 16 && j === 19) ||
                (i === 16 && j === 20) ||
                (i === 16 && j === 22) ||
                (i === 16 && j === 23) ||
                (i === 16 && j === 24) ||
                (i === 16 && j === 25) ||
                (i === 16 && j === 26) ||
                (i === 17 && j === 1) ||
                (i === 17 && j === 2) ||
                (i === 17 && j === 3) ||
                (i === 17 && j === 4) ||
                (i === 17 && j === 5) ||
                (i === 17 && j === 7) ||
                (i === 17 && j === 8) ||
                (i === 17 && j === 10) ||
                (i === 17 && j === 11) ||
                (i === 17 && j === 12) ||
                (i === 17 && j === 13) ||
                (i === 17 && j === 14) ||
                (i === 17 && j === 15) ||
                (i === 17 && j === 16) ||
                (i === 17 && j === 17) ||
                (i === 17 && j === 19) ||
                (i === 17 && j === 20) ||
                (i === 17 && j === 22) ||
                (i === 17 && j === 23) ||
                (i === 17 && j === 24) ||
                (i === 17 && j === 25) ||
                (i === 17 && j === 26) ||
                (i === 18 && j === 1) ||
                (i === 18 && j === 2) ||
                (i === 18 && j === 3) ||
                (i === 18 && j === 4) ||
                (i === 18 && j === 5) ||
                (i === 18 && j === 7) ||
                (i === 18 && j === 8) ||
                (i === 18 && j === 10) ||
                (i === 18 && j === 11) ||
                (i === 18 && j === 12) ||
                (i === 18 && j === 13) ||
                (i === 18 && j === 14) ||
                (i === 18 && j === 15) ||
                (i === 18 && j === 16) ||
                (i === 18 && j === 17) ||
                (i === 18 && j === 19) ||
                (i === 18 && j === 20) ||
                (i === 18 && j === 22) ||
                (i === 18 && j === 23) ||
                (i === 18 && j === 24) ||
                (i === 18 && j === 25) ||
                (i === 18 && j === 26) ||
                (i === 19 && j === 13) ||
                (i === 19 && j === 14) ||
                (i === 20 && j === 3) ||
                (i === 20 && j === 4) ||
                (i === 20 && j === 5) ||
                (i === 20 && j === 7) ||
                (i === 20 && j === 8) ||
                (i === 20 && j === 9) ||
                (i === 20 && j === 10) ||
                (i === 20 && j === 11) ||
                (i === 20 && j === 13) ||
                (i === 20 && j === 14) ||
                (i === 20 && j === 16) ||
                (i === 20 && j === 17) ||
                (i === 20 && j === 18) ||
                (i === 20 && j === 19) ||
                (i === 20 && j === 20) ||
                (i === 20 && j === 22) ||
                (i === 20 && j === 23) ||
                (i === 20 && j === 24) ||
                (i === 20 && j === 25) ||
                (i === 21 && j === 3) ||
                (i === 21 && j === 4) ||
                (i === 21 && j === 5) ||
                (i === 21 && j === 7) ||
                (i === 21 && j === 8) ||
                (i === 21 && j === 9) ||
                (i === 21 && j === 10) ||
                (i === 21 && j === 11) ||
                (i === 21 && j === 16) ||
                (i === 21 && j === 17) ||
                (i === 21 && j === 18) ||
                (i === 21 && j === 19) ||
                (i === 21 && j === 20) ||
                (i === 21 && j === 22) ||
                (i === 21 && j === 23) ||
                (i === 21 && j === 24) ||
                (i === 21 && j === 25) ||
                (i === 22 && j === 4) ||
                (i === 22 && j === 5) ||
                (i === 22 && j === 22) ||
                (i === 22 && j === 23) ||
                (i === 23 && j === 1) ||
                (i === 23 && j === 2) ||
                (i === 23 && j === 4) ||
                (i === 23 && j === 5) ||
                (i === 23 && j === 7) ||
                (i === 23 && j === 8) ||
                (i === 23 && j === 10) ||
                (i === 23 && j === 11) ||
                (i === 23 && j === 12) ||
                (i === 23 && j === 13) ||
                (i === 23 && j === 14) ||
                (i === 23 && j === 15) ||
                (i === 23 && j === 16) ||
                (i === 23 && j === 17) ||
                (i === 23 && j === 19) ||
                (i === 23 && j === 20) ||
                (i === 23 && j === 22) ||
                (i === 23 && j === 23) ||
                (i === 23 && j === 25) ||
                (i === 23 && j === 26) ||
                (i === 24 && j === 1) ||
                (i === 24 && j === 2) ||
                (i === 24 && j === 7) ||
                (i === 24 && j === 8) ||
                (i === 24 && j === 13) ||
                (i === 24 && j === 14) ||
                (i === 24 && j === 19) ||
                (i === 24 && j === 20) ||
                (i === 24 && j === 25) ||
                (i === 24 && j === 26) ||
                (i === 25 && j === 1) ||
                (i === 25 && j === 2) ||
                (i === 25 && j === 4) ||
                (i === 25 && j === 5) ||
                (i === 25 && j === 6) ||
                (i === 25 && j === 7) ||
                (i === 25 && j === 8) ||
                (i === 25 && j === 9) ||
                (i === 25 && j === 10) ||
                (i === 25 && j === 11) ||
                (i === 25 && j === 13) ||
                (i === 25 && j === 14) ||
                (i === 25 && j === 13) ||
                (i === 25 && j === 16) ||
                (i === 25 && j === 17) ||
                (i === 25 && j === 18) ||
                (i === 25 && j === 19) ||
                (i === 25 && j === 20) ||
                (i === 25 && j === 21) ||
                (i === 25 && j === 22) ||
                (i === 25 && j === 23) ||
                (i === 25 && j === 25) ||
                (i === 25 && j === 26)) {
                board[i][j] = WALL;
                gFoodCount--
            }

        }
    }
    return board;
}

function updateScore(diff) {
    gGame.score += diff
    document.querySelector('h2 span').innerText = gGame.score

}

function gameOver() {
    gGame.isOn = false
    clearInterval(gIntervalGhosts)
    clearInterval(cherryInterval)
    document.querySelector(".game-over").hidden = false

}

function reSet() {
    document.querySelector("h2 span").innerText = 0
    document.querySelector(".game-over").hidden = true
    document.querySelector(".victory").hidden = true
    gGhosts = []
    gFoodCount = 0

    gGame = {
        score: 1,
        isOn: false
    }
    init();
}

function victory() {
    gGame.isOn = false
    clearInterval(gIntervalGhosts)
    clearInterval(cherryInterval)
    document.querySelector(".victory").hidden = false
}

function addNewCherry() {
    if (gCherryCount > 0) return

    var emptyCells = []

    for (var i = 0; i < gBoard.length; i++) {
        for (var j = 0; j < gBoard[0].length; j++) {
            if (gBoard[i][j] === ' ') emptyCells.push({ i: i, j: j })
        }
    }

    if (!emptyCells.length) return

    var emptyCellIdx = getRandomIntInclusive(0, emptyCells.length - 1)

    var newCerryPos = emptyCells[emptyCellIdx]

    gBoard[newCerryPos.i][newCerryPos.j] = CHERRY;

    renderCell(newCerryPos, cherryImg);

    gCherryCount++;

}


